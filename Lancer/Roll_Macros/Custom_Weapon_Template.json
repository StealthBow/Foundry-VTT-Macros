{
  "name": "Custom Weapon Template",
  "type": "script",
  "scope": "global",
  "command": "//Form Defaults, modify as required.\r\nlet formTitle = \"Attack & Damage Roll\"; //Default title for pop-up.\r\nlet accDefault = 0; //Default Accuracy (e.g. Accurate Tag).\r\nlet difDefault = 0; //Default Difficulty (e.g. Inaccurate Tag).\r\n\r\n//Pilot Details, modify as required.\r\nlet grit = 0; //Pilot GRIT.\r\nlet brutalTalent = false; //(true/false) When rolling nat 20 and getting a crit, roll max damage.\r\n\r\n//Weapon Details, modify as required.\r\nlet numDice = 1; //Number of dice a weapon uses for damage, e.g. Assault Rifle uses 1d6.\r\nlet diceType = \"d6\"; //Type of dice for damage.\r\nlet damageMod = 0; //Any +/- bonuses to damage.\r\nlet damageDetails = \"Kinetic Damage, Reliable 2\"; //(e.g. \"Kinetic Damage, AP\"). This will appear above the damage roll in chat.\r\n\r\n//Other Details, modify as required.\r\nlet rollDetails = \"Assault Rifle Attack\"; //(e.g. \"Tech Attack\"). This will appear above the main roll in chat.\r\n\r\n\r\n\r\n//Script below here.\r\nlet run = false;\r\nnew Dialog({\r\n  title: `${formTitle}`,\r\n  content: `\r\n    <form>\r\n      <div class=\"form-group\">\r\n        <label>Accuracy:</label>\r\n        <input type=\"number\" id=\"acc-input\" name=\"acc-input\" value=\"${accDefault}\"/>\r\n      </div>\r\n      <div class=\"form-group\">\r\n        <label>Difficulty:</label>\r\n        <input type=\"number\" id=\"dif-input\" name=\"dif-input\" value=\"${difDefault}\"/>\r\n      </div>\r\n    </form>\r\n    `,\r\n  buttons: {\r\n    yes: {\r\n      icon: \"<i class='fas fa-check'></i>\",\r\n      label: `Roll!`,\r\n      callback: () => run = true\r\n    },\r\n    no: {\r\n      icon: \"<i class='fas fa-times'></i>\",\r\n      label: `Cancel`\r\n    },\r\n  },\r\n  default: \"yes\",\r\n  close: html => {\r\n    if (run) {\r\n      let accDif = (html.find('[name=\"acc-input\"]')[0].value) - (html.find('[name=\"dif-input\"]')[0].value);\r\n\r\n      let attackRollFormula = `d20`;\r\n      if (accDif != 0){ attackRollFormula += `+${accDif}d6kh`; }\r\n      if (grit != 0) {attackRollFormula += `+${grit}` };\r\n\r\n      let attack = new Roll(attackRollFormula);\r\n      attack.roll().toMessage({flavor: rollDetails});\r\n\r\n      let damageRollFormula = ``;\r\n      if (attack.total >= 20) {\r\n        if (brutalTalent && (attack.parts[0].results[0] == 20)) {\r\n          damageRollFormula = `(${numDice}*${diceType})`;\r\n        } else {\r\n          damageRollFormula = `(2*${numDice})${diceType}kh${numDice}`;\r\n        }\r\n      }\r\n      else {\r\n        damageRollFormula = `${numDice}${diceType}`;\r\n      }\r\n      if (damageMod !=0) {damageRollFormula += `+${damageMod}`}\r\n      \r\n      let damageDealt = new Roll(damageRollFormula).roll();\r\n      damageDealt.toMessage({flavor: damageDetails});\r\n    }\r\n  }\r\n}).render(true);",
  "img": "icons/svg/dice-target.svg"
}